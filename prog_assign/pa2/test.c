/**
* @file test.c
* @brief contains functions to test the ability of an fir function
*
* Course: CPE2600
* Section: 121
* Assignment: Problem Assignment 2
* Name: Leigh Goetsch
*
*/

#define FILTER_SIZE 7
#define DATA_SIZE 512
#define ROUND 100

// Filter Coefficients
#define FIR_COEFF {0.0212, 0.0897, 0.2343, 0.3094, 0.2343, 0.0897, 0.0212}
// Input generated from matlab
#define GENERATED_INPUT {-0.0433609296474824, -0.0168469878275448, -0.0218533560026581, 0.0541334435719376, 0.0389266203843264, 0.0751228984688333, 0.177825589929100, 0.122306255173381, -0.128325610460477, -0.232895451628334, 0.0901931466951715, -0.183563868373519, 0.00667569114368658, 0.00354794858375770, 0.222716807816787, -0.00692142540220484, -0.0507323064614498, 0.0235809672576244, 0.0245804851893843, 0.00700452094168079, -0.0608580510079949, -0.122259338018663, 0.0316500360797716, -0.134286923662193, -0.103218434407217, 0.133121588506497, -0.0418903195029849, -0.0140321722056366, 0.0899822328897224, -0.0300111005615676, 0.102936571210310, -0.0345065971567321, 0.101280186426298, 0.0629334584931419, -0.0213015082641055, -0.0865697308360524, -0.104310830133763, -0.0270068812648099, -0.0438141355602144, -0.0408674314796326, 0.0983545235205556, -0.0297697144009373, 0.114367891077096, -0.0531620117507069, 0.0972565728008653, -0.0522250484993549, 0.0176577794642316, 0.0970737823554689, -0.0413972274974230, -0.0438270518204902, 0.200339061086226, 0.0950993499549085, -0.0432003843727780, 0.0648940737363587, -0.0360076301153972, 0.0705885019349416, 0.141584906843659, -0.160451566859706, 0.102885306900203, 0.145796778066199, 0.00474713232748285, 0.174625671011842, 0.0155387514201181, -0.123711968466263, -0.219349427883461, -0.0333407067263734, 0.0713543302564059, 0.0317407733234497, 0.0413610390293130, -0.0577085583637940, 0.0144001801404465, -0.163866572993389, -0.0760089998635267, -0.0818793096250257, 0.0519728888133619, -0.00141600590972047, -0.115552936828724, -0.000952491609816556, -0.0689810537631710, -0.0666699153601165, 0.0864149421165126, 0.0113419436226868, 0.0398362846165994, 0.0883969890234671, 0.0180257693987047, 0.0550854522057470, 0.0682964276111937, 0.117060866003560, 0.0475860587278343, 0.141223268644450, 0.00226084843095982, -0.00478694102202059, 0.170133465427496, -0.0509711712767427, -0.000285496014432121, 0.0919867079806396, 0.0149808732632761, 0.140493344567698, 0.103412153956971, 0.0291570288770806, -0.0777698538311604, 0.0566696097539305, -0.138262115948035, 0.0244474675589888, 0.0808438803167691, 0.0213041698417000, 0.0879677164233489, 0.203887625141404, 0.0923932448688937, 0.0266917446595828, 0.0641661506421779, 0.0425485355625296, -0.131472350348688, -0.0416411219699434, 0.122468782478534, -0.00435842055463326, 0.0582423277447969, -0.100650007461934, 0.00645167423111044, 0.0600291949185784, -0.136151495486457, 0.0347592631960065, -0.0181843218459334, -0.0939534765941492, -0.00375331888191716, -0.189630449362245, -0.212797676818267, -0.117692333071496, -0.0990532220484176, -0.117303232726741, -0.172542778952869, 0.0288228089665011, -0.159418372026681, 0.0110218849223381, 0.0787066676357980, -0.000222678631383614, 0.00931087600588035, -0.0378157056589758, -0.148267611105900, -0.00438185853582948, 0.0960825211682115, 0.173824493261334, -0.0430206242426101, -0.162732273646978, 0.0166347492460066, 0.0376265910450719, -0.0226950464706233, -0.114891228961879, 0.202433259954387, -0.235952351095849, -0.0509972045799939, -0.132162559081010, -0.0636128249660042, 0.0317851419059697, 0.0138047974449526, -0.0710735074811226, 0.0777003526719788, 0.0622393924172013, 0.0647380884516047, -0.0425631681660351, 0.104858076053644, 0.0660707086367175, 0.250877247318511, 0.106345963904102, 0.115692165332739, 0.00529788273256128, -0.128838600294029, -0.0371221247497632, -0.0757791916498819, -0.0563968917027427, 0.0555138560001846, -0.0556778063950366, -0.0895113135482436, -0.0409327721634070, -0.0160886766738443, 0.0409334430455455, -0.0952635997119978, 0.0317317472324612, 0.00780200809780775, 0.132438544916022, -0.0213170486421586, -0.0134478644555426, -0.117135581792030, -0.138526268319524, 0.0310508318600499, -0.0249489064473939, 0.0503744055737328, -0.0892661403477038, 0.190851233035822, 0.0122230700504887, 0.104703326689793, -0.0226920199323937, -0.0162501941548495, 0.0690051897857806, 0.0555756771412105, -0.112025500148841, -0.153269301392951, -0.109786776954067, -0.141577332156794, 0.00595705885660458, -0.0411250925532220, -0.0368010733040955, -0.136096312939369, 0.0779567428734972, 0.0439411111553712, -0.00896224837412097, 0.102118011801418, -0.0873979465028903, 0.0414700293047628, 0.0348441199952281, 0.0349254416663714, -0.0729247267629504, 0.0326840248762991, -0.0514881632926476, -0.0896446150502486, -0.120326818641502, 0.103781563948524, -0.0845944212336118, -0.0172913844259168, -0.120865205474020, -0.0297126799995404, -0.323203779594001, -0.108695922946133, -0.142643615947972, -0.101445076770532, -0.0213267188307358, -0.0325347780360491, 0.194439779196628, -0.0571773218349456, -0.0250032278035044, -0.156931547034070, -0.0477382663694067, -0.133797665356226, 0.00302990237881831, 0.0853086767518578, 0.0404253465109360, -0.0700620213418206, -0.163054289274725, 0.146001318514265, 0.205004273293787, 0.0120500599699389, -0.0989901604221187, 0.119777147431488, -0.0592656218169254, -0.0469809363224455, 0.0886377377072694, -0.138521980111084, -0.195675395423192, 0.0420683700201250, 0.0400737998146962, 0.00951421578641687, 0.0496684391636530, 0.108224059616070, 0.0970447788354572, -0.0568569570389605, 0.0809972073318538, 0.0173247371832088, -0.0505542568515379, -0.119330579089020, 0.0646970938881150, -0.0353622599299341, 0.00464345266878230, -0.0792947502201808, -0.155051447477956, 0.0171586355268628, -0.00621391248043618, 0.119902787729197, 0.0801704070327278, 0.105330457914955, -0.0748876752543159, -0.0936326497116021, -0.126908677286849, 0.0497980623046732, 0.278908112764392, 0.0727572036915723, -0.0773064102152237, 0.0836633754476153, -0.112833031008360, -0.142447009141638, 0.0717442315507358, -0.0777905520185398, 0.0315985880708604, 0.140653513807679, 0.0401124635731864, 0.0929660284419656, -0.160580220462075, 0.0661536244123409, 0.213850225382851, 0.0541139413417132, -0.154087718185788, -0.0203142794821834, -0.0499965221779343, 0.0383023912780829, 0.0412035378111751, 0.0405492550516440, -0.0363780750881015, -0.0599272040041946, -0.0589588991418034, 0.0853540834064481, -0.185300807141960, -0.0207303159647625, 0.0270378202689916, -0.0652771012058928, 0.0477227285007673, -0.00713196500274540, -0.0938301288268817, 0.0161363534650636, -0.0268182881913388, -0.0409872647756742, -0.0711322710526139, 0.00614454835840975, -0.184612923609859, -0.0398333119478132, -0.0543548121612387, -0.0911898504288660, 0.0652698590995241, -0.0734271258590912, 0.0540633089814446, 0.0975840884581828, -0.0156870414727051, 0.0277799321723375, 0.0639517303110873, -0.00809780150606096, 0.0540870143763936, -0.126256484462796, 0.111042384067016, -0.0989562679068364, -0.182883593420384, 0.138449851135426, -0.00627267940412559, 0.0448921120019170, -0.0363258472467672, -0.102058339313102, -0.307298853928707, 0.0626278997699139, -0.0286684533211225, -0.0197342906850919, 0.0405605372640549, -0.141934846053479, -0.0729445237982782, 0.114732784158513, 0.0597864632881486, -0.128128125909253, -0.220326424216990, -0.0571246319791095, 0.0213996478716457, 0.0942376933302384, 0.00937254906669184, -0.112231172152804, 0.0306157818568223, -0.117233486755329, -0.0960966563537669, -0.0653735016358028, -0.122939364899916, -0.0270965129963311, -0.0899950067342813, -0.0285686137601834, -0.0462421544353747, -0.0409785214740165, -0.0503538984131873, 0.123329711264414, 0.0610305217573950, 0.00590721550526544, -0.146694673042825, -0.162580326639623, -0.196475241539089, 0.260519575087392, 0.0972374811203577, 0.0256980969704260, -0.0974240459346947, -0.114636438588742, 0.0547639504480465, 0.156508398508243, -0.169334366132081, -0.0449397359860250, -0.00842920727534208, -0.199199717760327, 0.0841245666352581, -0.0414658917455486, 0.191218083836386, -0.0390898732233772, 0.0409182082547355, -0.114242816812144, -0.0624863775636729, -0.116872284991455, 0.0392575281297536, 0.130183950434961, -0.0593641761840396, 0.0436375391562132, -0.0504362480525810, 0.0102107713303418, 0.119625054082237, 0.0120282816361650, -0.103684339707676, -0.0857103238887738, -0.0169874304044058, -0.0191668280046305, -0.0865815207739937, 0.0180664133586186, 0.126652847557265, -0.0251169287438378, -0.0204570050663136, -0.220152190603627, -0.0774513104760749, -0.139327258405515, -0.0386234650983645, 0.0525586350117865, 0.152326927539060, 0.179849445190826, -0.0116884266969787, -0.0320196186885630, 0.0817516283237215, 0.0490159188823982, 0.0765251160015635, 0.0778279045311317, -0.148030517341863, 0.0540363959609767, -0.00915390218682469, -0.0760252376958568, -0.0693595443143502, 0.128145775266336, -0.0809737610765752, -0.123681835282285, 0.0214686448131779, 0.201077176753361, 0.00255544334123088, 0.0308299436246859, -0.0938247210627779, 0.167421595177913, 0.0124988173845023, 0.0530101256550695, -0.0952068223401487, 0.0854042818220478, 0.0389145734517764, -0.115600108495170, 0.00397401269892484, -0.0450598603707587, 0.0109247941665665, -0.0250552842446154, -0.0189901654648676, -0.103291351430084, -0.0323291921419398, 0.0766526854105447, 0.174467317966905, -0.116051992616979, 0.237741185238417, 0.152607796250707, 0.0168507500217456, -0.0301206529323699, -0.0698654270705207, 0.0832770575778025, -0.0694605254222804, -0.0461882993134125, 0.0883617136720828, 0.0435944182163725, 0.0896747363054464, 0.0504732027944892, -0.0400897135515841, -0.0513848012099214, 0.0796367596233902, -0.0671190164007305, 0.118665904286638, 0.0790701970703587, 0.0287721494673668, 0.000322611456308685, 0.0365617187472922, 0.352667781833885, -0.0112436662512024, -0.155659393493828, 0.191510229545677, 0.0609846053238310, -0.0647911623091645, 0.261733491205073, 0.0550950420745412, 0.0294203684446698, -0.0777843798253388, -0.106493009609004, -0.176841403231106, -0.0422919535898430, -0.105310242919018, 0.0647755244971729, -0.0317628188513513, 0.176899156918657, 0.151058239519276, 0.0164010316907443, -0.0282763714505208, 0.115216580794839, -0.114650763211670, 0.0673698696541778, -0.0669112995372736, -0.0400322700634663, -0.0671802427219058, 0.0575629016583151, -0.0778093515420814, -0.106356120288467, 0.0552978301286998, -0.0423428837836487, 0.0361587164848056, -0.0351889241946106, 0.0269540707973063, -0.256444935612109, 0.0465864128078826, 0.185356094249385, 0.103928933984721, 0.0910896579458498, -0.0239731286601329, 0.0180998079792441, 0.0244249546813347, 0.00963928845397177, -0.0830468497619261, -0.0352252185662263, -0.0174775039544099}
// expected output generated from matlab
#define EXPECT_OUTPUT {-0.000921266011742421, -0.00424847132969250, -0.0121367821572975, -0.0181739897289003, -0.0148100409350945, 0.00317440383810453, 0.0288349823127846, 0.0585677641512053, 0.0866748065427508, 0.0894627350085832, 0.0380274174776597, -0.0438738503247695, -0.0825681279451156, -0.0779260133578735, -0.0526663409899844, -0.0171378404649632, 0.0385991353114624, 0.0607643998763304, 0.0412583886706007, 0.0106204754685083, 0.00461392694838987, 0.00201519659975669, -0.0155931646160224, -0.0431438825053372, -0.0577616475785747, -0.0620694072444853, -0.0595266407830114, -0.0360226133307381, -0.00354049466232630, 0.0102676460062048, 0.0161736006704601, 0.0250916097978672, 0.0328287132200888, 0.0349290812584230, 0.0415917683886338, 0.0428444165923488, 0.0273200830246804, -0.0137081506314615, -0.0517746941128318, -0.0642613691014851, -0.0528633926138446, -0.0324671783621976, -0.00474404538845085, 0.0185046479399410, 0.0333360484820911, 0.0315241538403299, 0.0282505502682205, 0.0186707106267517, 0.0162604871578009, 0.0189239899208477, 0.0221756168000174, 0.0201400196780360, 0.0403854518837962, 0.0698489865162585, 0.0664914385802401, 0.0394389565767159, 0.0236476200060029, 0.0280465104477933, 0.0392740423854728, 0.0332244497771467, 0.0263957309866095, 0.0467373403089121, 0.0749403478926172, 0.0811422915541862, 0.0582886403238882, -0.000127437142300276, -0.0717415156153816, -0.0924867136895455, -0.0520386217778095, 0.00187714577983988, 0.0237094913112384, 0.0102160103162780, -0.0167417178188787, -0.0516410556697493, -0.0756774998995180, -0.0764038623054464, -0.0479443196465049, -0.0241283970927961, -0.0258495523617483, -0.0409884348629756, -0.0467057864391090, -0.0395918784234731, -0.0172183707372173, 0.0130138737431360, 0.0339607527664941, 0.0448219106303865, 0.0501555817718658, 0.0516299347923297, 0.0575631530015324, 0.0722355457001674, 0.0814175394408645, 0.0826466063359934, 0.0705137042177462, 0.0536099247033713, 0.0480193896443188, 0.0447042047807559, 0.0322211249139265, 0.0290155066538911, 0.0457478149805150, 0.0679021876492023, 0.0804221279577391, 0.0692743309397215, 0.0301008377985093, -0.00357190228238882, -0.0243658103002281, -0.0224209465939739, 0.00132170488007407, 0.0367568956768833, 0.0656621298218698, 0.0966165190120001, 0.112733178979860, 0.0976248705322235, 0.0661322512802075, 0.0360186205649007, 0.000615882145434489, -0.0232437312470592, -0.00896595727332103, 0.0193067656736752, 0.0255748569101628, 0.00537081198411825, -0.0112761236543265, -0.0138671321143758, -0.0168812542411218, -0.0250995578027364, -0.0283981970444061, -0.0348036839059406, -0.0555188768113719, -0.0901010296297984, -0.130895946522634, -0.151566565364574, -0.140775151999975, -0.123704543582327, -0.115818654932800, -0.0995749062183003, -0.0788401586742788, -0.0509023441119469, -0.0164052840605712, 0.0132225021339702, 0.0116152116544016, -0.0121331622329815, -0.0409615171674210, -0.0426164008856264, -0.00209730398460371, 0.0480090473444707, 0.0484232185546705, 0.000108827502763995, -0.0359997016866935, -0.0288138774961490, -0.0113013805136889, -0.0139422160962942, -0.0119526675237523, -0.0282033640572416, -0.0615159595977730, -0.0913497076307823, -0.0814715007969056, -0.0530633419794737, -0.0195054515953272, -0.00515707683883996, 0.00791324452760558, 0.0287880098418248, 0.0449596000886198, 0.0409139232608850, 0.0450668757234625, 0.0698511363098004, 0.113358637707180, 0.137019439777823, 0.124695914325987, 0.0735210206838920, 0.00848976323220764, -0.0426767708386743, -0.0603812883133495, -0.0530095129826643, -0.0351631942159597, -0.0255761838670100, -0.0358777342601972, -0.0471243164183907, -0.0395773146906408, -0.0220651443008967, -0.0159905802219323, -0.0112453571469533, 0.00408339977630979, 0.0310082209938630, 0.0349362719038240, 0.00920919559339748, -0.0363254018736919, -0.0686962858351794, -0.0658592516566100, -0.0368731189761124, -0.00751073631080239, 0.00604766239831659, 0.0306512827318346, 0.0538962948085561, 0.0637195122724476, 0.0451767152055059, 0.0262305845069073, 0.0180854935093451, 0.0174456486359647, -0.0109111037471272, -0.0645650672924950, -0.105522058383997, -0.112269373178858, -0.0887376502649161, -0.0602706074410497, -0.0455419375601155, -0.0474600875737020, -0.0322742544973978, -0.000285952143791971, 0.0240752615849998, 0.0285960179829568, 0.0190742808286717, 0.0106049843181196, 0.0110717644608072, 0.0171616950475283, 0.00558472621117630, -0.00923616934954039, -0.0257676791401654, -0.0436701388285665, -0.0590997104368448, -0.0457983656111850, -0.0291671920282327, -0.0300821242405330, -0.0562734348122139, -0.0851032537179640, -0.129384971243740, -0.158596443682448, -0.157582188309650, -0.125611146155995, -0.0852176105326765, -0.0368710505729410, 0.0127058590203760, 0.0294892290216407, 0.00354717357391801, -0.0482798282647201, -0.0785387672691522, -0.0842711243665917, -0.0579713019420607, -0.0159040891846361, 0.0138070893725145, 0.00198129168983668, -0.0252385278719057, -0.00856317422114499, 0.0485526088794806, 0.0780079349312628, 0.0476940875409581, 0.0154447619028478, 0.00307833796258127, -0.00489374732241051, -0.0155951704353997, -0.0354813463442841, -0.0687886539832221, -0.0723902460302050, -0.0320835479512161, 0.0107419254457805, 0.0353625272702400, 0.0549456691916474, 0.0661879842596284, 0.0543560655053896, 0.0353759305296099, 0.0197316001179548, 0.000122053027771528, -0.0284314344930746, -0.0334047152170220, -0.0216687717162989, -0.0168819814549854, -0.0357090340515706, -0.0601694940281509, -0.0608770296491554, -0.0270354914406574, 0.0240299668585805, 0.0605323417318034, 0.0686820900592330, 0.0333550735299575, -0.0210165348386501, -0.0547088102868141, -0.0274471540702845, 0.0459189932462446, 0.0964759545702458, 0.0766335277716481, 0.0256689692337291, -0.0174738414928217, -0.0492906482087762, -0.0541447036098646, -0.0319345309233900, -0.00155718015596897, 0.0334922045750053, 0.0597955757775366, 0.0553351933224493, 0.0243040102936211, 0.0145293885697540, 0.0437254449826187, 0.0676565306612333, 0.0303856708769534, -0.0228322407329044, -0.0403977438414185, -0.0193705557453218, 0.00755884024119105, 0.0217708476203345, 0.00942121566353785, -0.0147618254078582, -0.0326465770132053, -0.0317520138516535, -0.0382655426470213, -0.0477114784363272, -0.0419373578460412, -0.0224712263202214, -0.0111078698803016, -0.00829326654741326, -0.0174155148598672, -0.0273024290656971, -0.0280942566386758, -0.0289428938571162, -0.0395509788177232, -0.0496466042373910, -0.0670046394604049, -0.0790798073536291, -0.0760773164343459, -0.0596575081326434, -0.0385916524148121, -0.0171803079319246, 0.00433144814990960, 0.0254891108005510, 0.0378344520687781, 0.0333801641152510, 0.0302318209502584, 0.0272345906876382, 0.0183451707414466, -0.000560505602923649, -0.0124998231759333, -0.0272057259146348, -0.0453411677464073, -0.0396564989790901, -0.00475357699940543, 0.0170830451501406, -0.00324237885064566, -0.0484976968184065, -0.103193862341022, -0.109612905911685, -0.0701893627498433, -0.0279353467963941, -0.0185135283274434, -0.0306841343758029, -0.0423173983860025, -0.0230808141404064, 0.00436349096670407, -0.0151843400711899, -0.0731879742985264, -0.0998539228577751, -0.0658604329134268, -0.00871678596363149, 0.0171413609569262, -0.000354105189680366, -0.0290032475021399, -0.0514668156930758, -0.0699638580463456, -0.0837663088283061, -0.0857649326504336, -0.0795000321982871, -0.0697340729479162, -0.0583272699181494, -0.0505536186056602, -0.0411522645147407, -0.0274270926756174, 0.00456386692676477, 0.0334132122366798, 0.0271618861077446, -0.0270122571067204, -0.0860971644035082, -0.103449526112174, -0.0416036229058078, 0.0398798378527371, 0.0648949578836890, 0.0179854951122508, -0.0284848565205050, -0.0306477688506641, 0.00241198824424481, 0.00500805261006096, -0.0287571510160503, -0.0564394316189340, -0.0650189800031828, -0.0511807546628332, -0.0157530502283587, 0.0310024771718804, 0.0448444462942093, 0.0287919079158919, -0.0150848466645273, -0.0494968343628543, -0.0643615407865952, -0.0405643088681208, 0.00283227295952080, 0.0265961586132236, 0.0190960641181527, 0.00374380744338477, 0.00544220050439376, 0.0209027260158337, 0.0275001785965057, -0.000749770021519750, -0.0403264804826963, -0.0547339459484347, -0.0462640287360597, -0.0357809915352081, -0.0195605719591773, 0.0102107491936145, 0.0228446437823742, -0.00450295534796418, -0.0619656441207511, -0.103940939979268, -0.112918628284816, -0.0825424193522478, -0.0264206762892108, 0.0446476354693342, 0.0934349593957955, 0.0913594842801714, 0.0541857243366634, 0.0319085734701681, 0.0405683043942472, 0.0529712635178857, 0.0479209276277166, 0.0181120647057777, -0.00942842494844062, -0.0198010245226507, -0.0231138361571897, -0.0304392741864493, -0.0188121448979989, -0.0132376229053977, -0.0256467078782032, -0.0240902761885150, 0.0211201467842024, 0.0557965025567000, 0.0495713027049195, 0.0219361795243541, 0.0241773598916942, 0.0382956613025175, 0.0410302625125740, 0.0185377387935634, 0.00869281138422506, 0.00796647370040081, -0.00305288446944915, -0.0238864326021926, -0.0306643697094414, -0.0226468037063844, -0.0190482133984816, -0.0235550693401245, -0.0372005110976198, -0.0354149240318074, -0.00529266629301151, 0.0419906457720586, 0.0642246133727215, 0.0809297557406597, 0.100276131477568, 0.0959821502150263, 0.0482824566642680, 0.00299780148664589, -0.0116188987145226, -0.0114947217677237, -0.0108536223624750, 0.00194319228491553, 0.0313860575290966, 0.0532644866694121, 0.0520459289827074, 0.0301058211636738, 0.00207447561767635, -0.00369794199190800, 0.00667222682269724, 0.0279462967111701, 0.0481569418893323, 0.0554888550739452, 0.0475008352877838, 0.0564294498062901, 0.0939746549394486, 0.105788385816929, 0.0644530052644739, 0.0305974378661939, 0.0432981106483711, 0.0590117465812349, 0.0750219174233548, 0.0892340943150728, 0.0715135193601294, 0.0125806087233228, -0.0483878276516810, -0.0948371277042857, -0.104005353901935, -0.0852727834033653, -0.0445345771436205, -0.000549904500314053, 0.0503597555645954, 0.0871314052885984, 0.0904701047459384, 0.0569453177545246, 0.0305503185417517, 0.0114587540279455, -0.00172883219517944, -0.0169844637194778, -0.0269394881571865, -0.0366873220804997, -0.0304903593272898, -0.0295476404018555, -0.0383238157800170, -0.0374744792133786, -0.0209980304103556, -0.00544983862701704, -0.00730924450451468, -0.0207416675422426, -0.0495372239317977, -0.0456591988773922, 0.0106861307369502, 0.0778454338116995, 0.0939001412615755, 0.0666824350605091, 0.0338290033135596, 0.0151873374327561, 0.00564170239171139, -0.0131719568731125}

#include <math.h>
#include <stdio.h>
#include "filter.h"

void test(double h[], double x[], double y[],const double out[]) {
    // call filter
    fir_filter(h, x, y);

    // Output the result
    printf("test output:\n");
    for (int i = 0; i < DATA_SIZE; i++) {
        double y_i = round(y[i]*ROUND)/ROUND;
        double out_i = round(out[i]*ROUND)/ROUND;
        if (y_i != out_i) {
            printf("Mismatch at position %3d: %.4f should be %.4f \n", i, y[i], out[i]);
        }
    }
    printf("\n");
}

void test_constant_data(){
    printf("Constant input test started.\n");
    // set FIR coefficients
    double h[FILTER_SIZE] = FIR_COEFF;
    // set all input to 1
    double x[DATA_SIZE] = {1};
    // init output
    double y[DATA_SIZE];

    // init expected output
    double out[DATA_SIZE] = {1};
    for (int i = 0; i < DATA_SIZE; i++) {
        x[i] = 1;
        out[i] = 0.9998;
    }

    test(h, x, y, out);
}

// Test function with 1 at position 256
void test_impulse_data() {
    printf("Single input test started.\n");
    // set FIR coefficients
    double h[FILTER_SIZE] = FIR_COEFF;
    // set all input to 0
    double x[DATA_SIZE] = {0};
    // set input at 256 to 1
    x[255] = 1;
    // init output
    double y[DATA_SIZE];

    // init expected output
    double out[DATA_SIZE] = {0};

    // add coeffients 
    for (int i = 0; i < FILTER_SIZE; i++){
        out[254 + (FILTER_SIZE - i)] = h[i];
        
    }

    for (int i =0; i < DATA_SIZE; i++) {
        printf("%lf\t", x[i]);
    }
    

    test(h, x, y, out);
}


// Test function with noisy input data
void test_noisy_data() {
    printf("Noisy input test started.\n");
    // set FIR coefficients
    double h[FILTER_SIZE] = FIR_COEFF;
    // set input to generated input
    double x[DATA_SIZE] = GENERATED_INPUT;
    // init output
    double y[DATA_SIZE];
    // set expected output to generated expected output
    double out[DATA_SIZE] = EXPECT_OUTPUT;

    printf("The first 5 values will not match the expected output for this test.\n");

    test(h, x, y, out);
}
